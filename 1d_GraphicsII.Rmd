---
title: "Graphics part II"
author: "Pablo Gomez"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = F, message = F)
library(dplyr); library(ggplot2); library(ggpubr);library(Pabloverse)
```

# Further customization

## Other aesthetics

```{r fill}
PRRS %>% 
  ggplot() + # we call ggplot
  geom_boxplot(aes(y = Age, fill = Sex)) # we add a boxplot layer
```

```{r col}
PRRS %>% 
  ggplot() +
  geom_boxplot(aes(y = Age, col = Sex))
```

### Non aesthetics customization

So far we have added variables inside our `aes()` function, but we can add some arguments outside the `aes()` function that we want them to be applied for all observations. For example, we can change the outline of the boxplot to be the same for the two groups, but the fill color different per group:

```{r}
PRRS %>% 
  ggplot() + # we call ggplot
  geom_boxplot(
    aes(y = Age, fill = Sex), # This is the normal aesthetics we define
    col = 'red' # all aesthetics we define here will be applied to all th ebservations
  ) # we add a boxplot layer
```

## Colors

To define specific colors for our figure, we can use the function `scale_*_manual` where the * represents the aesthetic we want to represent. If we want to use the color for the fill, we would use:

```{r colors}
PRRS %>% 
  ggplot() +
  geom_boxplot(aes(y = Age, fill = Sex)) +
  scale_fill_manual(values = c('red', 'green'))
```


R manages colors in three different ways: by name (i.e: 'red'), by rgb value using the function `rgb()` (i.e. `rgb(1, 0, 0)`), or using [hexadecimal code](https://marketing.istockphoto.com/blog/hex-colors-guide/) (i.e. "#F00000"). You can get a full list of the named colors in R by using the function `colors()`, but you will only be able to see the names. Luckly someone made a tool that can help us exacly the colors that we want: the *Colour Picker* addin. Addins are tools that are available in Rstudio to facilitate tasks, lets try the colour picker (should be already in your addins toolbar).

![](img/1c_colPicker.gif)

**Exercise: ** Pick two colors you like and use them to create a boxplot of the distribution of age by the test result.

```{r include = F}
PRRS %>% 
  ggplot() +
  geom_boxplot(aes(y = Age, fill = Result), col = 'grey20') +
  scale_fill_manual(values = c('red4', 'blue4'))
```


## Labels

Usually we try to avoid spaces when using names for the column names, but for our plots this could be not the most straight forward way to communicate our analysis, we can set specific labels to make our plots more readable and self explanatory. lets improve our figure a bit more

```{r}
PRRS %>% 
  ggplot() +
  geom_boxplot(aes(y = Age, fill = farm_type)) +
  labs(
    title = 'Distribution of Age by Farm type',
    x = 'Farm type',
    fill = 'Farm Type'
  )
```

## Themes

ggplot includes the function `theme()` to define most of the aspects of the figure such as the background color, the grid, axes, legend, among many others. There is also several predefined themes that you can use, if dont want to mess with all the arguments from the function `theme()`. For example:

```{r}
# all the predefined themes start with theme_
PRRS %>% 
  ggplot() +
  geom_boxplot(aes(y = Age, fill = farm_type)) +
  labs(title = 'Distribution of Age by Farm type', x = 'Farm type', fill = 'Farm Type') +
  theme_minimal()
```


# Facets

```{r}
PRRS %>% 
  ggplot() +
  geom_histogram(aes(Age)) +
  facet_grid(rows = vars(Sex), cols = vars(Result)) +
  theme_classic()
```



# Further customization

# Layouts

# Exporting plots

# Interactive figures

------------------------------------------------------------------------

*This lab has been developed with contributions from: [Jose Pablo
Gomez-Vazquez](https://www.spablo-temporal.network).\
Feel free to use these training materials for your own research and
teaching. When using the materials we would appreciate using the proper
credits. If you would be interested in a training session, please
contact: [jpgo\@ucdavis.edu](mailto:jpgo@ucdavis.edu){.email}*

------------------------------------------------------------------------
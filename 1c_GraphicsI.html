<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Pablo Gomez" />


<title>Graphics part I</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CADMS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pre Workshop
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Intro_to_R.html">Intro to R</a>
    </li>
    <li>
      <a href="Spatial_intro.html">Intro to Spatial data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Contact
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Instructors.html">
        <span class="fa fa-users"></span>
         
        Instructors
      </a>
    </li>
    <li>
      <a href="https://cadms.vetmed.ucdavis.edu">
        <span class="fa fa-server"></span>
         
        CADMS Website
      </a>
    </li>
    <li>
      <a href="mailto:jpgo@ucdavis.edu">
        <span class="fa fa-envelope"></span>
         
        Email
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Graphics part I</h1>
<h4 class="author">Pablo Gomez</h4>

</div>


<p>We will continue using the data set from the previous section to
introduce some basics of data visualization. Some libraries can include
data sets that once you install the library you can use. In this case we
will use data from the <code>STNet</code> library, if you dont have it
installed yet make sure you do by using:</p>
<pre class="r"><code># Install STNet from github
devtools::install_github(&#39;spablotemporal/STNet&#39;)</code></pre>
<pre class="r"><code># Load the libraries
library(ggplot2) # for graphics
library(dplyr) # For data manipulation
library(STNet)

# loading the data from the package
farms &lt;- STNet::SwineFarms
PRRS &lt;- STNet::PRRS
mov &lt;- STNet::SwineMov</code></pre>
<div id="plots-in-r" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Plots in R</h1>
<p>By default R already has a set of functions to create a variety of
figures, but the code can get quite complex and difficult to read as we
produce more detailed figures. <code>ggplot2</code> is a library that
provides a set of functions for producing a variety of figures.</p>
<p>The basic components that we need to define for a plot are the
following:</p>
<ul>
<li><em>data</em>, the data set we will use to generate the figure</li>
<li><em>geometry</em>, or type of graphic we will generate
(i.e. histogram, bar, scatter, etc..)</li>
<li><em>aesthetic</em>, variables or arguments that will be used for the
figure for example: location, color, size, etc..</li>
</ul>
<p>An example:</p>
<pre class="r"><code>ggplot(data = PRRS) + # This is the data we will use
  geom_histogram( # This is the geometry 
    aes(x = Age) # The aesthetic includes only one variable representing the x axis
  )</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/hist%20example-1.png" width="672" /></p>
<p>Other components of the plots can be defined to further customize our
figures, and we will cover those more in detail in future
sections.<br />
As you noticed in the previous example, we can print the figures
directly from the R console, but a way I like to organize our figures is
to put them all inside a single object in R. This object can be a
<code>list</code>, which is just a container for other objects.</p>
<pre class="r"><code># To create an empty list we can use the function list()
figures &lt;- list()</code></pre>
</div>
<div id="visualizing-distributions" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Visualizing
distributions</h1>
<div id="continous-variables" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Continous
variables</h2>
<div id="histograms" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Histograms</h3>
<p>The most simple way to visualize the distribution of a continuous
variable is using a histogram. Histograms are a special kind of bar
plots where our variable is grouped in bins and showing the counts for
each bin. Now that we have our container list for the plots, we can
simply save it there and assign a name we want.</p>
<pre class="r"><code>figures$histogram &lt;- PRRS %&gt;% 
  ggplot() +
  geom_histogram(aes(x = Age))

# we can see our plot by calling the name in our container list
figures$histogram</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/hist-1.png" width="672" /></p>
</div>
<div id="boxplots" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Boxplots</h3>
<p>Box plots are great to show the distribution of a continuous
variable. We can use it to show only one variable, or multiple
variables. It is important to be very descriptive when making plots, the
idea of a figure is that can explain itself. we will start to slowly
introduce functions to do this and customize our figures.</p>
<pre class="r"><code># Only one variable
figures$box &lt;- PRRS %&gt;% 
  ggplot() +
  geom_boxplot(aes(y = Age)) +
  labs(title = &#39;Distribution of Age&#39;) # we can add different labels such as the main title

figures$box</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/boxplot-1.png" width="672" /></p>
</div>
</div>
<div id="frequencies-barplots-bubbles-mozaics-pie-charts"
class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Frequencies
(Barplots, bubbles, mozaics, Pie charts)</h2>
<div id="barplots" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Barplots</h3>
<pre class="r"><code>figures$bars &lt;- PRRS %&gt;% 
  count(farm_type) %&gt;% 
  ggplot() +
  geom_bar(aes(
    x = farm_type, # X axis
    y = n # Y axis
  ), stat = &#39;identity&#39;) # type of barplot

figures$bars</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/barplots-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="visualizing-relationships" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Visualizing
relationships</h1>
<div id="scatterplots" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Scatterplots</h2>
<p>This is one of the most popular kind of plots, it is useful to
represent relationship between two continuous variables.<br />
We can achieve the same result in different ways. The first one is
better when we have our variables in the same dataset, and the second
one when we have data from different objects. (the length of the two
vectors has to be the same).</p>
<pre class="r"><code>figures$scatter &lt;- farms %&gt;% # first we start with the name of our data.frame
  ggplot() + # then we call ggplot
  geom_point(aes(x = outgoing, y = incoming)) # and we add layer for points

figures$scatter</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
</div>
<div id="time-series" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Time series</h1>
<p>To create a time series we will need to reformat the data a little
bit so R can do what we want. We will introduce a new kind of variable:
<code>date</code>. The date variables are pretty much what it sounds
like, is a variable that has a format with year, month and day; there
are other ways to format dates in R, but this is the most common and
straight forward.</p>
<pre class="r"><code>mov &lt;- mov %&gt;% 
  mutate(date = as.Date(date, &quot;%m/%d/%y&quot;), # First we will format the date
         week = format(date, &quot;%V&quot;),
         week = lubridate::floor_date(date, &#39;week&#39;)) # The we create a variable formatting the date as week of the year</code></pre>
<p>Now that we have our variables in the correct format, we can use it
as any other variable.</p>
<pre class="r"><code>figures$timeseries &lt;- mov %&gt;% 
  count(week) %&gt;% 
  ggplot() +
  geom_line(aes(x = week, y = n))

figures$timeseries</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="arranging-the-plots-in-a-layout" class="section level1"
number="5">
<h1><span class="header-section-number">5</span> Arranging the plots in
a layout</h1>
<p>Now that we have all the figures in a list, we can make arrangements
with our figures. For this we use the function <code>ggarrange()</code>
from the ggpubr library.</p>
<pre class="r"><code>library(ggpubr) # load the library
ggarrange(plotlist = figures)</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="further-customization" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Further
customization</h1>
<div id="labels" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Labels</h2>
<p>Usually we try to avoid spaces when using names for the column names,
but for our plots this could be not the most straight forward way to
communicate our analysis, we can set specific labels to make our plots
more readable and self explanatory. Let’s improve bar plot figure a bit
more to make it clearer:</p>
<pre class="r"><code>figures$bars &lt;- PRRS %&gt;% 
  count(farm_type) %&gt;% 
  ggplot() +
  geom_bar(aes(x = farm_type, y = n), stat = &#39;identity&#39;) + # type of barplot
  labs(# We will use the function labs to generate our labels
    title = &#39;Number of farms by type&#39;,
    x = &#39;Farm type&#39;,
    y = &#39;Number of farms&#39;
  )

figures$bars</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="themes" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Themes</h2>
<p>ggplot includes the function <code>theme()</code> to define most of
the aspects of the figure such as the background color, the grid, axes,
legend, among many others. There is also several predefined themes (all
start with <code>theme_</code> followed by the name of the theme) that
you can use, if don’t want to mess with all the arguments from the
function <code>theme()</code>. For example:</p>
<pre class="r"><code># all the predefined themes start with theme_
figures$timeseries &lt;- mov %&gt;% 
  count(week) %&gt;% 
  ggplot() +
  geom_line(aes(x = week, y = n)) +
  theme_minimal() # We will use the theme minimal

figures$timeseries</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="other-aesthetics" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Other aesthetics</h2>
<div id="shape" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Shape</h3>
<p>There are other aesthetics we can define such as color, type of
point, size, among many others. Lets try changing the point shape for
one of the plots we previously did:</p>
<pre class="r"><code>figures$scatter &lt;- farms %&gt;% # the data we are using
  ggplot() + # we call ggplot
  geom_point(aes(
    x = outgoing, # X axis
    y = incoming, # Y axis
    shape = farm_type # point shape
  )) +
  labs(title = &#39;Movements by farm&#39;) +
  theme_classic() # now lets try the theme &#39;classic&#39;

figures$scatter</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="color" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Color</h3>
<p>In the next example we will use the Sex of the animal to color our
boxplot:</p>
<pre class="r"><code>PRRS %&gt;% 
  ggplot() + # we call ggplot
  geom_boxplot(aes(y = Age, fill = Sex)) # we add a boxplot layer</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/fill-1.png" width="672" /></p>
<p>We can also use the variable to color other parts of the plot such as
the border:</p>
<pre class="r"><code>PRRS %&gt;% 
  ggplot() +
  geom_boxplot(aes(y = Age, col = Sex))</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/col-1.png" width="672" /></p>
</div>
<div id="non-aesthetics-customization" class="section level3"
number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Non aesthetics
customization</h3>
<p>So far we have added variables inside our <code>aes()</code>
function, but we can add some arguments outside the <code>aes()</code>
function that we want them to be applied for all observations. For
example, we can change the outline of the boxplot to be the same for the
two groups, but the fill color different per group:</p>
<pre class="r"><code>PRRS %&gt;% 
  ggplot() + # we call ggplot
  geom_boxplot(
    aes(y = Age, fill = Sex), # This is the normal aesthetics we define
    col = &#39;red&#39; # all aesthetics we define here will be applied to all th ebservations
  ) # we add a boxplot layer</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="colors" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Colors</h2>
<p>To define specific colors for our figure, we can use the function
<code>scale_*_manual</code> where the * represents the aesthetic we want
to represent. If we want to use the color for the fill, we would
use:</p>
<pre class="r"><code>figures$box &lt;- PRRS %&gt;% 
  ggplot() +
  geom_boxplot(aes(y = Age, fill = Sex)) +
  scale_fill_manual(values = c(&#39;red&#39;, &#39;green&#39;))

figures$box</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/colors-1.png" width="672" /></p>
<p>R manages colors in three different ways: by name (i.e: ‘red’), by
rgb value using the function <code>rgb()</code>
(i.e. <code>rgb(1, 0, 0)</code>), or using <a
href="https://marketing.istockphoto.com/blog/hex-colors-guide/">hexadecimal
code</a> (i.e. “#F00000”). You can get a full list of the named colors
in R by using the function <code>colors()</code>, but you will only be
able to see the names. Luckly someone made a tool that can help us
exacly the colors that we want: the <em>Colour Picker</em> addin. Addins
are tools that are available in Rstudio to facilitate tasks, lets try
the colour picker (should be already in your addins toolbar).</p>
<p><img src="img/1c_colPicker.gif" /></p>
<p><strong>Exercise: </strong> Pick two colors you like and use them to
create a boxplot of the distribution of age by the test result.</p>
</div>
</div>
<div id="facets" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Facets</h1>
<p>Facets are a way of stratifying the data based on variables in the
data set, you can think about it in a similar way we have been using
groups. To create a stratified plot we can use the function
<code>facet_grid()</code> which will ask for a variable to go in the
rows and another for columns:</p>
<pre class="r"><code>figures$histogram &lt;- PRRS %&gt;% # The data we will use 
  ggplot() + # we call ggplot
  geom_histogram(aes(Age)) + # We will create a histogram of the Age
  facet_grid(
    rows = vars(Sex), # We will use the Sex variable for rows
    cols = vars(Result) # We use the Result variable for Columns
  ) +
  theme_linedraw() # lets try another theme

figures$histogram</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="exporting-plots" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Exporting plots</h1>
<p>Now that we have a good mix of different figures, lets export them.
We can use the function <code>ggsave()</code> to export a high
definition figure.</p>
<pre class="r"><code>ggsave(figures$histogram, filename = &#39;myHistogram.png&#39;)</code></pre>
<div id="more-customization" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> More
customization</h2>
<p>You can create more detailed arrangements of figures like i will show
in the following example:</p>
<pre class="r"><code>ggarrange( # Funciton to arrange the figures
  figures$box, figures$scatter, figures$bars, figures$timeseries, # These are the figures I will arrange
  heights = c(5, 3), # We can define the heights for each of the rows
  labels = c(&quot;A&quot;,&quot;B&quot;, &quot;C&quot;, &quot;D&quot;) # add a label for each figure
) %&gt;% 
  annotate_figure( # Function to annotate the figure
    top = text_grob( # Top title
      label = &#39;Distribution of the data&#39;, # Label for title
      face = &#39;bold&#39;, # Bold letters
      size = 18 # Size of the title
    )
  )</code></pre>
<p><img src="1c_GraphicsI_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="interactive-figures" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Interactive
figures</h1>
<p>Having static figures is the most common application of graphics in
R, but R is also capable of making interactive figures that can be used
in dashboards and other platforms (i.e. shiny, or quarto). There are
several libraries that allow you to create interactive figures, one of
the most popular ones is called <code>plotly</code>. The best part of
plotly is that if you learn how to use ggplot, you can transfer your
figures to interactive plotly figures pretty much seamesly. Lets try
that.</p>
<p>We use the function <code>ggplotly()</code> from the
<code>plotly</code> library to do that:</p>
<pre class="r"><code>library(plotly) # laod the plotly library
# Use the ggplotly function in one of the figures we previouslt created:
ggplotly(figures$histogram)</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d6baf828c2eea81d7915" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d6baf828c2eea81d7915">{"x":{"data":[{"orientation":"v","width":[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[6,12,18,24,30,36,42,48,54,60,66,72,78,84,90,96,102,108,114,120,126,132,138,144,150,156,162,168,174,180],"y":[67,45,19,25,16,17,8,14,0,9,0,4,0,2,0,2,0,0,0,1,0,0,0,0,0,0,0,0,0,0],"text":["count:  67<br />Age:   6","count:  45<br />Age:  12","count:  19<br />Age:  18","count:  25<br />Age:  24","count:  16<br />Age:  30","count:  17<br />Age:  36","count:   8<br />Age:  42","count:  14<br />Age:  48","count:   0<br />Age:  54","count:   9<br />Age:  60","count:   0<br />Age:  66","count:   4<br />Age:  72","count:   0<br />Age:  78","count:   2<br />Age:  84","count:   0<br />Age:  90","count:   2<br />Age:  96","count:   0<br />Age: 102","count:   0<br />Age: 108","count:   0<br />Age: 114","count:   1<br />Age: 120","count:   0<br />Age: 126","count:   0<br />Age: 132","count:   0<br />Age: 138","count:   0<br />Age: 144","count:   0<br />Age: 150","count:   0<br />Age: 156","count:   0<br />Age: 162","count:   0<br />Age: 168","count:   0<br />Age: 174","count:   0<br />Age: 180"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[6,12,18,24,30,36,42,48,54,60,66,72,78,84,90,96,102,108,114,120,126,132,138,144,150,156,162,168,174,180],"y":[53,56,74,106,44,88,32,96,9,75,11,42,4,14,4,16,0,3,0,5,0,2,0,2,0,0,0,0,0,1],"text":["count:  53<br />Age:   6","count:  56<br />Age:  12","count:  74<br />Age:  18","count: 106<br />Age:  24","count:  44<br />Age:  30","count:  88<br />Age:  36","count:  32<br />Age:  42","count:  96<br />Age:  48","count:   9<br />Age:  54","count:  75<br />Age:  60","count:  11<br />Age:  66","count:  42<br />Age:  72","count:   4<br />Age:  78","count:  14<br />Age:  84","count:   4<br />Age:  90","count:  16<br />Age:  96","count:   0<br />Age: 102","count:   3<br />Age: 108","count:   0<br />Age: 114","count:   5<br />Age: 120","count:   0<br />Age: 126","count:   2<br />Age: 132","count:   0<br />Age: 138","count:   2<br />Age: 144","count:   0<br />Age: 150","count:   0<br />Age: 156","count:   0<br />Age: 162","count:   0<br />Age: 168","count:   0<br />Age: 174","count:   1<br />Age: 180"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[6,12,18,24,30,36,42,48,54,60,66,72,78,84,90,96,102,108,114,120,126,132,138,144,150,156,162,168,174,180],"y":[49,34,22,28,2,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"text":["count:  49<br />Age:   6","count:  34<br />Age:  12","count:  22<br />Age:  18","count:  28<br />Age:  24","count:   2<br />Age:  30","count:   1<br />Age:  36","count:   1<br />Age:  42","count:   0<br />Age:  48","count:   0<br />Age:  54","count:   0<br />Age:  60","count:   0<br />Age:  66","count:   0<br />Age:  72","count:   0<br />Age:  78","count:   0<br />Age:  84","count:   0<br />Age:  90","count:   1<br />Age:  96","count:   0<br />Age: 102","count:   0<br />Age: 108","count:   0<br />Age: 114","count:   0<br />Age: 120","count:   0<br />Age: 126","count:   0<br />Age: 132","count:   0<br />Age: 138","count:   0<br />Age: 144","count:   0<br />Age: 150","count:   0<br />Age: 156","count:   0<br />Age: 162","count:   0<br />Age: 168","count:   0<br />Age: 174","count:   0<br />Age: 180"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[6,12,18,24,30,36,42,48,54,60,66,72,78,84,90,96,102,108,114,120,126,132,138,144,150,156,162,168,174,180],"y":[30,59,76,43,6,10,3,4,1,4,0,6,1,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"text":["count:  30<br />Age:   6","count:  59<br />Age:  12","count:  76<br />Age:  18","count:  43<br />Age:  24","count:   6<br />Age:  30","count:  10<br />Age:  36","count:   3<br />Age:  42","count:   4<br />Age:  48","count:   1<br />Age:  54","count:   4<br />Age:  60","count:   0<br />Age:  66","count:   6<br />Age:  72","count:   1<br />Age:  78","count:   4<br />Age:  84","count:   2<br />Age:  90","count:   0<br />Age:  96","count:   0<br />Age: 102","count:   0<br />Age: 108","count:   0<br />Age: 114","count:   0<br />Age: 120","count:   0<br />Age: 126","count:   0<br />Age: 132","count:   0<br />Age: 138","count:   0<br />Age: 144","count:   0<br />Age: 150","count:   0<br />Age: 156","count:   0<br />Age: 162","count:   0<br />Age: 168","count:   0<br />Age: 174","count:   0<br />Age: 180"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":37.9178082191781,"r":18.9954337899543,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,0.489128071319852],"automargin":true,"type":"linear","autorange":false,"range":[-6,192],"tickmode":"array","ticktext":["0","50","100","150"],"tickvals":[0,50,100,150],"categoryorder":"array","categoryarray":["0","50","100","150"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(0,0,0,1)","gridwidth":0.066417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"annotations":[{"text":"Age","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.9178082191781},{"text":"count","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-27.7625570776256},{"text":"0","x":0.244564035659926,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"1","x":0.755435964340074,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"H         ","x":1,"y":0.757610350076104,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"M         ","x":1,"y":0.242389649923896,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"yaxis":{"domain":[0.515220700152207,1],"automargin":true,"type":"linear","autorange":false,"range":[-5.3,111.3],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(0,0,0,1)","gridwidth":0.066417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.489128071319852,"y0":0.515220700152207,"y1":1},{"type":"rect","fillcolor":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.489128071319852,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.510871928680148,"x1":1,"y0":0.515220700152207,"y1":1},{"type":"rect","fillcolor":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.510871928680148,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.515220700152207,"y1":1,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.489128071319852,"y0":0,"y1":0.484779299847793},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.510871928680148,"x1":1,"y0":0,"y1":0.484779299847793},{"type":"rect","fillcolor":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.484779299847793,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[-6,192],"tickmode":"array","ticktext":["0","50","100","150"],"tickvals":[0,50,100,150],"categoryorder":"array","categoryarray":["0","50","100","150"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.510871928680148,1],"gridcolor":"rgba(0,0,0,1)","gridwidth":0.066417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-5.3,111.3],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.484779299847793],"gridcolor":"rgba(0,0,0,1)","gridwidth":0.066417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"6a4a6b3e46eb":{"x":{},"type":"bar"}},"cur_data":"6a4a6b3e46eb","visdat":{"6a4a6b3e46eb":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="other-type-of-figures" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Other type of
figures</h1>
<p>Here we did not covered all the different visualization tools
available in R, there are several other type of figures you can do. A
good resource for this is the <a href="https://r-graph-gallery.com"
class="uri">https://r-graph-gallery.com</a>. this is a website that has
multiple categories of figures and code to reproduce them all. Let’s
take some time to explore the different types of visualizations
available. Go to the website and explore on your own for a little
bit.</p>
<hr />
<p><em>This lab has been developed with contributions from: <a
href="https://www.spablo-temporal.network">Jose Pablo
Gomez-Vazquez</a>.<br />
Feel free to use these training materials for your own research and
teaching. When using the materials we would appreciate using the proper
credits. If you would be interested in a training session, please
contact: <a href="mailto:jpgo@ucdavis.edu"
class="email">jpgo@ucdavis.edu</a></em></p>
<hr />
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
